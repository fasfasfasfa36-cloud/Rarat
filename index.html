<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–£–≥–∞–¥–∞–π —Å–ª–æ–≤–æ!</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif; background: var(--tg-theme-bg-color, #ffffff); color: var(--tg-theme-text-color, #000000); display: flex; flex-direction: column; align-items: center; min-height: 100vh; padding: 10px; box-sizing: border-box; }
        h1 { margin: 10px 0; font-size: 28px; text-align: center; }
        #word { font-size: 36px; font-weight: bold; letter-spacing: 8px; margin: 20px 0; min-height: 50px; }
        #hangman { width: 200px; height: 200px; border: 2px solid var(--tg-theme-hint-color, #999); border-radius: 12px; margin: 20px 0; background: var(--tg-theme-secondary-bg-color, #f0f0f0); }
        #lives { font-size: 24px; margin: 10px 0; }
        #keyboard { display: grid; grid-template-columns: repeat(11, 1fr); gap: 4px; max-width: 400px; margin: 20px 0; }
        .key { background: var(--tg-theme-button-color, #0088cc); color: var(--tg-theme-button-text-color, #ffffff); border: none; padding: 12px; border-radius: 8px; font-size: 18px; font-weight: bold; touch-action: manipulation; }
        .key:disabled { background: var(--tg-theme-hint-color, #999); opacity: 0.5; cursor: not-allowed; }
        .key.correct { background: #4CAF50; }
        .key.wrong { background: #f44336; }
        #status { font-size: 20px; margin: 10px 0; text-align: center; }
        #scores { margin: 20px 0; font-size: 18px; text-align: center; }
        button { background: var(--tg-theme-button-color, #0088cc); color: var(--tg-theme-button-text-color, #ffffff); border: none; padding: 14px 28px; border-radius: 12px; font-size: 18px; margin: 10px; cursor: pointer; }
    </style>
</head>
<body>
    <h1>–£–≥–∞–¥–∞–π —Å–ª–æ–≤–æ!</h1>
    <canvas id="hangman" width="200" height="200"></canvas>
    <div id="word">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
    <div id="lives">‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</div>
    <div id="status">–í—ã–±–µ—Ä–∏ –±—É–∫–≤—É!</div>
    <div id="keyboard"></div>
    <div id="scores">–ü–æ–±–µ–¥—ã: 0 | –ü–æ—Ä–∞–∂–µ–Ω–∏—è: 0 | –õ—É—á—à–∞—è —Å–µ—Ä–∏—è: 0</div>
    <button id="newGame">–ù–æ–≤–∞—è –∏–≥—Ä–∞</button>

    <script>
        const WebApp = window.Telegram.WebApp;
        WebApp.ready();
        WebApp.expand();

        const words = ['–ö–û–¢', '–°–û–ë–ê–ö–ê', '–î–û–ú', '–ú–ê–®–ò–ù–ê', '–†–ï–ö–ê', '–ì–û–†–ê', '–õ–ï–°', '–ù–ï–ë–û', '–°–û–õ–ù–¶–ï', '–õ–£–ù–ê', '–ó–í–ï–ó–î–ê', '–î–ï–†–ï–í–û', '–¶–í–ï–¢–û–ö', '–ü–¢–ò–¶–ê', '–†–´–ë–ê', '–ö–û–†–ê–ë–õ–¨', '–°–ê–ú–û–õ–ï–¢', '–ü–û–ï–ó–î', '–ê–í–¢–û–ë–£–°', '–í–ï–õ–û–°–ò–ü–ï–î', '–ö–ù–ò–ì–ê', '–ö–ê–ù–ò–ö–£–õ–´', '–®–ö–û–õ–ê', '–£–ù–ò–í–ï–†–°–ò–¢–ï–¢', '–†–ê–ë–û–¢–ê', '–î–†–£–ì', '–°–ï–ú–¨–Ø', '–õ–Æ–ë–û–í–¨', '–°–ß–ê–°–¢–¨–ï', '–ú–ï–ß–¢–ê', '–ö–û–ú–ü–¨–Æ–¢–ï–†', '–¢–ï–õ–ï–§–û–ù', '–ò–ù–¢–ï–†–ù–ï–¢', '–ò–ì–†–ê', '–ë–û–¢', '–ü–ò–†–ê–ú–ò–î–ê', '–°–§–ò–ù–ö–°', '–ü–ò–†–ê–¢', '–°–û–ö–†–û–í–ò–©–ï', '–û–°–¢–†–û–í', '–í–û–õ–ù–ê', '–ë–£–†–Ø', '–®–¢–û–†–ú', '–ú–û–†–ï', '–û–ö–ï–ê–ù'];

        const canvas = document.getElementById('hangman');
        const ctx = canvas.getContext('2d');
        const wordDiv = document.getElementById('word');
        const livesDiv = document.getElementById('lives');
        const statusDiv = document.getElementById('status');
        const keyboardDiv = document.getElementById('keyboard');
        const scoresDiv = document.getElementById('scores');
        const newGameBtn = document.getElementById('newGame');

        let currentWord = '';
        let guessedLetters = new Set();
        let lives = 6;
        let scores = JSON.parse(localStorage.getItem('hangman_scores')) || { wins: 0, losses: 0, bestStreak: 0 };
        let currentStreak = scores.currentStreak || 0;

        const russianLetters = '–ê–ë–í–ì–î–ï–Å–ñ–ó–ò–ô–ö–õ–ú–ù–û–ü–†–°–¢–£–§–•–¶–ß–®–©–™–´–¨–≠–Æ–Ø'.split('');

        function updateScores() {
            scores.currentStreak = currentStreak;
            if (currentStreak > scores.bestStreak) scores.bestStreak = currentStreak;
            scoresDiv.textContent = `–ü–æ–±–µ–¥—ã: ${scores.wins} | –ü–æ—Ä–∞–∂–µ–Ω–∏—è: ${scores.losses} | –õ—É—á—à–∞—è —Å–µ—Ä–∏—è: ${scores.bestStreak}`;
            localStorage.setItem('hangman_scores', JSON.stringify(scores));
        }

        function drawHangman() {
            ctx.clearRect(0, 0, 200, 200);
            ctx.strokeStyle = 'var(--tg-theme-hint-color, #666)';
            ctx.lineWidth = 4;
            ctx.lineCap = 'round';

            ctx.beginPath();
            ctx.moveTo(20, 180); ctx.lineTo(180, 180); ctx.lineTo(180, 20); ctx.lineTo(140, 20); ctx.lineTo(140, 50);
            ctx.stroke();

            if (lives < 6) { ctx.beginPath(); ctx.arc(140, 70, 15, 0, Math.PI * 2); ctx.stroke(); }
            if (lives < 5) { ctx.beginPath(); ctx.moveTo(140, 85); ctx.lineTo(140, 130); ctx.stroke(); }
            if (lives < 4) { ctx.beginPath(); ctx.moveTo(140, 95); ctx.lineTo(110, 110); ctx.stroke(); }
            if (lives < 3) { ctx.beginPath(); ctx.moveTo(140, 95); ctx.lineTo(170, 110); ctx.stroke(); }
            if (lives < 2) { ctx.beginPath(); ctx.moveTo(140, 130); ctx.lineTo(120, 160); ctx.stroke(); }
            if (lives < 1) { ctx.beginPath(); ctx.moveTo(140, 130); ctx.lineTo(160, 160); ctx.stroke(); }
        }

        function updateWordDisplay() {
            wordDiv.textContent = currentWord.split('').map(l => guessedLetters.has(l) ? l : '_').join(' ');
        }

        function updateLives() {
            livesDiv.textContent = '‚ù§Ô∏è'.repeat(lives) + 'üíî'.repeat(6 - lives);
        }

        function createKeyboard() {
            keyboardDiv.innerHTML = '';
            russianLetters.forEach(letter => {
                const btn = document.createElement('button');
                btn.classList.add('key');
                btn.textContent = letter;
                btn.addEventListener('click', () => guessLetter(letter));
                keyboardDiv.appendChild(btn);
            });
        }

        function guessLetter(letter) {
            if (guessedLetters.has(letter)) return;
            guessedLetters.add(letter);
            const buttons = keyboardDiv.querySelectorAll('.key');
            const idx = russianLetters.indexOf(letter);
            buttons[idx].disabled = true;

            if (currentWord.includes(letter)) {
                buttons[idx].classList.add('correct');
                updateWordDisplay();
                if (currentWord.split('').every(l => guessedLetters.has(l))) {
                    statusDiv.textContent = '–ü–æ–±–µ–¥–∞! üéâ';
                    scores.wins++; currentStreak++; updateScores();
                }
            } else {
                buttons[idx].classList.add('wrong');
                lives--; updateLives(); drawHangman();
                if (lives === 0) {
                    statusDiv.textContent = `–ü—Ä–æ–∏–≥—Ä–∞–ª! –°–ª–æ–≤–æ: ${currentWord}`;
                    scores.losses++; currentStreak = 0; updateScores();
                } else {
                    statusDiv.textContent = `–ù–µ–≤–µ—Ä–Ω–æ! –û—Å—Ç–∞–ª–æ—Å—å: ${lives}`;
                }
            }
        }

        function newGame() {
            currentWord = words[Math.floor(Math.random() * words.length)];
            guessedLetters.clear();
            lives = 6;
            statusDiv.textContent = '–í—ã–±–µ—Ä–∏ –±—É–∫–≤—É!';
            updateWordDisplay();
            updateLives();
            drawHangman();
            createKeyboard();
        }

        newGameBtn.addEventListener('click', newGame);
        updateScores();
        newGame();  // –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –ø–µ—Ä–≤–æ–π –∏–≥—Ä—ã
    </script>
</body>
</html>
