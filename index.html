<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–£–≥–∞–¥–∞–π —Å–ª–æ–≤–æ! üéØ</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            margin: 0;
            padding: 20px 10px;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--tg-theme-bg-color, #ffffff);
            color: var(--tg-theme-text-color, #000000);
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            box-sizing: border-box;
        }
        h1 {
            font-size: 32px;
            margin: 0 0 10px;
            text-align: center;
            background: linear-gradient(90deg, #0088cc, #ff4d4d);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        #category {
            font-size: 18px;
            color: var(--tg-theme-hint-color, #999);
            margin-bottom: 10px;
        }
        #hangman {
            width: 220px;
            height: 220px;
            margin: 20px 0;
            filter: drop-shadow(0 4px 8px rgba(0,0,0,0.2));
        }
        #word {
            font-size: 40px;
            font-weight: bold;
            letter-spacing: 10px;
            margin: 20px 0;
            min-height: 60px;
        }
        #lives {
            font-size: 28px;
            margin: 15px 0;
        }
        #status {
            font-size: 22px;
            margin: 15px 0;
            font-weight: bold;
            min-height: 30px;
            text-align: center;
        }
        #keyboard {
            display: grid;
            grid-template-columns: repeat(11, 1fr);
            gap: 6px;
            max-width: 450px;
            margin: 20px 0;
        }
        .key {
            background: var(--tg-theme-button-color, #0088cc);
            color: var(--tg-theme-button-text-color, #ffffff);
            border: none;
            padding: 14px;
            border-radius: 12px;
            font-size: 20px;
            font-weight: bold;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            transition: all 0.2s;
        }
        .key:active {
            transform: scale(0.95);
        }
        .key:disabled {
            opacity: 0.5;
            box-shadow: none;
        }
        .key.correct {
            background: #4CAF50 !important;
            animation: pulse 0.5s;
        }
        .key.wrong {
            background: #f44336 !important;
            animation: shake 0.5s;
        }
        #scores {
            font-size: 20px;
            margin: 20px 0;
            padding: 10px 20px;
            background: var(--tg-theme-secondary-bg-color, #f0f0f0);
            border-radius: 12px;
        }
        button {
            background: var(--tg-theme-button-color, #0088cc);
            color: var(--tg-theme-button-text-color, #ffffff);
            border: none;
            padding: 16px 32px;
            border-radius: 16px;
            font-size: 20px;
            font-weight: bold;
            box-shadow: 0 6px 12px rgba(0,0,0,0.2);
            margin: 20px;
            transition: all 0.3s;
        }
        button:active {
            transform: scale(0.95);
        }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }
        @keyframes shake { 0%,100% { transform: translateX(0); } 25% { transform: translateX(-10px); } 75% { transform: translateX(10px); } }
    </style>
</head>
<body>
    <h1>–£–≥–∞–¥–∞–π —Å–ª–æ–≤–æ! üéØ</h1>
    <div id="category"></div>
    <canvas id="hangman" width="220" height="220"></canvas>
    <div id="word"></div>
    <div id="lives">‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</div>
    <div id="status">–í—ã–±–µ—Ä–∏ –±—É–∫–≤—É!</div>
    <div id="keyboard"></div>
    <div id="scores">üèÜ –ü–æ–±–µ–¥—ã: 0 | üíî –ü–æ—Ä–∞–∂–µ–Ω–∏—è: 0 | üî• –°–µ—Ä–∏—è: 0 (—Ä–µ–∫–æ—Ä–¥: 0)</div>
    <button id="newGame">üîÑ –ù–æ–≤–∞—è –∏–≥—Ä–∞</button>

    <script>
        const WebApp = window.Telegram.WebApp;
        WebApp.ready();
        WebApp.expand();

        const words = [
            {word: '–ö–û–¢', cat: '–ñ–∏–≤–æ—Ç–Ω–æ–µ'}, {word: '–°–û–ë–ê–ö–ê', cat: '–ñ–∏–≤–æ—Ç–Ω–æ–µ'}, {word: '–ü–¢–ò–¶–ê', cat: '–ñ–∏–≤–æ—Ç–Ω–æ–µ'}, {word: '–†–´–ë–ê', cat: '–ñ–∏–≤–æ—Ç–Ω–æ–µ'},
            {word: '–ú–ê–®–ò–ù–ê', cat: '–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç'}, {word: '–°–ê–ú–û–õ–Å–¢', cat: '–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç'}, {word: '–ü–û–ï–ó–î', cat: '–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç'}, {word: '–ê–í–¢–û–ë–£–°', cat: '–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç'},
            {word: '–î–û–ú', cat: '–ó–¥–∞–Ω–∏–µ'}, {word: '–®–ö–û–õ–ê', cat: '–ó–¥–∞–Ω–∏–µ'}, {word: '–ì–û–†–ê', cat: '–ü—Ä–∏—Ä–æ–¥–∞'}, {word: '–†–ï–ö–ê', cat: '–ü—Ä–∏—Ä–æ–¥–∞'},
            {word: '–°–û–õ–ù–¶–ï', cat: '–ü—Ä–∏—Ä–æ–¥–∞'}, {word: '–õ–£–ù–ê', cat: '–ü—Ä–∏—Ä–æ–¥–∞'}, {word: '–ó–í–ï–ó–î–ê', cat: '–ü—Ä–∏—Ä–æ–¥–∞'}, {word: '–î–ï–†–ï–í–û', cat: '–ü—Ä–∏—Ä–æ–¥–∞'},
            {word: '–ö–ù–ò–ì–ê', cat: '–ü—Ä–µ–¥–º–µ—Ç'}, {word: '–¢–ï–õ–ï–§–û–ù', cat: '–ü—Ä–µ–¥–º–µ—Ç'}, {word: '–ö–û–ú–ü–¨–Æ–¢–ï–†', cat: '–ü—Ä–µ–¥–º–µ—Ç'}, {word: '–õ–Æ–ë–û–í–¨', cat: '–≠–º–æ—Ü–∏—è'},
            {word: '–î–†–£–ì', cat: '–ß–µ–ª–æ–≤–µ–∫'}, {word: '–°–ï–ú–¨–Ø', cat: '–ß–µ–ª–æ–≤–µ–∫'}, {word: '–°–ß–ê–°–¢–¨–ï', cat: '–≠–º–æ—Ü–∏—è'}, {word: '–ú–ï–ß–¢–ê', cat: '–ê–±—Å—Ç—Ä–∞–∫—Ç–Ω–æ–µ'},
            {word: '–ò–ù–¢–ï–†–ù–ï–¢', cat: '–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏'}, {word: '–ò–ì–†–ê', cat: '–†–∞–∑–≤–ª–µ—á–µ–Ω–∏–µ'}, {word: '–ë–û–¢', cat: '–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏'}, {word: '–ú–û–†–ï', cat: '–ü—Ä–∏—Ä–æ–¥–∞'},
            {word: '–û–ö–ï–ê–ù', cat: '–ü—Ä–∏—Ä–æ–¥–∞'}, {word: '–û–°–¢–†–û–í', cat: '–ü—Ä–∏—Ä–æ–¥–∞'}, {word: '–ü–ò–†–ê–¢', cat: '–§–∞–Ω—Ç–∞–∑–∏—è'}, {word: '–°–û–ö–†–û–í–ò–©–ï', cat: '–§–∞–Ω—Ç–∞–∑–∏—è'}
        ];

        const canvas = document.getElementById('hangman');
        const ctx = canvas.getContext('2d');
        const wordDiv = document.getElementById('word');
        const livesDiv = document.getElementById('lives');
        const statusDiv = document.getElementById('status');
        const keyboardDiv = document.getElementById('keyboard');
        const scoresDiv = document.getElementById('scores');
        const categoryDiv = document.getElementById('category');
        const newGameBtn = document.getElementById('newGame');

        let currentWordObj = null;
        let guessedLetters = new Set();
        let lives = 6;
        let scores = JSON.parse(localStorage.getItem('hangman_scores_v2')) || { wins: 0, losses: 0, bestStreak: 0 };
        let currentStreak = 0;

        const russianLetters = '–ê–ë–í–ì–î–ï–Å–ñ–ó–ò–ô–ö–õ–ú–ù–û–ü–†–°–¢–£–§–•–¶–ß–®–©–™–´–¨–≠–Æ–Ø'.split('');

        function updateScores() {
            scoresDiv.textContent = `üèÜ –ü–æ–±–µ–¥—ã: ${scores.wins} | üíî –ü–æ—Ä–∞–∂–µ–Ω–∏—è: ${scores.losses} | üî• –°–µ—Ä–∏—è: ${currentStreak} (—Ä–µ–∫–æ—Ä–¥: ${scores.bestStreak})`;
            localStorage.setItem('hangman_scores_v2', JSON.stringify(scores));
        }

        function drawHangman() {
            ctx.clearRect(0, 0, 220, 220);
            ctx.strokeStyle = var(--tg-theme-text-color, '#000');
            ctx.lineWidth = 6;
            ctx.lineCap = 'round';

            // –û—Å–Ω–æ–≤–∞–Ω–∏–µ
            ctx.beginPath();
            ctx.moveTo(20, 200); ctx.lineTo(200, 200); ctx.lineTo(180, 180); ctx.lineTo(40, 180); ctx.lineTo(20, 200);
            ctx.stroke();

            // –°—Ç–æ–ª–± –∏ –ø–µ—Ä–µ–∫–ª–∞–¥–∏–Ω–∞
            ctx.beginPath();
            ctx.moveTo(60, 180); ctx.lineTo(60, 20); ctx.lineTo(160, 20); ctx.lineTo(160, 50);
            ctx.stroke();

            if (lives < 6) { ctx.beginPath(); ctx.arc(160, 70, 20, 0, Math.PI*2); ctx.stroke(); } // –ì–æ–ª–æ–≤–∞
            if (lives < 5) { ctx.beginPath(); ctx.moveTo(160, 90); ctx.lineTo(160, 140); ctx.stroke(); } // –¢–µ–ª–æ
            if (lives < 4) { ctx.beginPath(); ctx.moveTo(160, 100); ctx.lineTo(130, 120); ctx.stroke(); } // –õ–µ–≤–∞—è —Ä—É–∫–∞
            if (lives < 3) { ctx.beginPath(); ctx.moveTo(160, 100); ctx.lineTo(190, 120); ctx.stroke(); } // –ü—Ä–∞–≤–∞—è —Ä—É–∫–∞
            if (lives < 2) { ctx.beginPath(); ctx.moveTo(160, 140); ctx.lineTo(140, 180); ctx.stroke(); } // –õ–µ–≤–∞—è –Ω–æ–≥–∞
            if (lives < 1) { ctx.beginPath(); ctx.moveTo(160, 140); ctx.lineTo(180, 180); ctx.stroke(); } // –ü—Ä–∞–≤–∞—è –Ω–æ–≥–∞
        }

        function updateWordDisplay() {
            wordDiv.textContent = currentWordObj.word.split('').map(l => guessedLetters.has(l) ? l : '_').join(' ');
        }

        function updateLives() {
            livesDiv.textContent = '‚ù§Ô∏è'.repeat(lives) + 'üñ§'.repeat(6 - lives);
        }

        function createKeyboard() {
            keyboardDiv.innerHTML = '';
            russianLetters.forEach(letter => {
                const btn = document.createElement('button');
                btn.classList.add('key');
                btn.textContent = letter;
                btn.addEventListener('click', () => guessLetter(letter));
                keyboardDiv.appendChild(btn);
            });
        }

        function guessLetter(letter) {
            if (guessedLetters.has(letter)) return;
            guessedLetters.add(letter);
            const buttons = keyboardDiv.querySelectorAll('.key');
            const idx = russianLetters.indexOf(letter);
            buttons[idx].disabled = true;

            if (currentWordObj.word.includes(letter)) {
                buttons[idx].classList.add('correct');
                updateWordDisplay();
                if (currentWordObj.word.split('').every(l => guessedLetters.has(l))) {
                    statusDiv.textContent = 'üéâ –ü–æ–±–µ–¥–∞! –ú–æ–ª–æ–¥–µ—Ü!';
                    scores.wins++;
                    currentStreak++;
                    if (currentStreak > scores.bestStreak) scores.bestStreak = currentStreak;
                    updateScores();
                }
            } else {
                buttons[idx].classList.add('wrong');
                lives--;
                updateLives();
                drawHangman();
                if (lives === 0) {
                    statusDiv.textContent = `üò¢ –ü—Ä–æ–∏–≥—Ä–∞–ª! –ë—ã–ª–æ: ${currentWordObj.word}`;
                    scores.losses++;
                    currentStreak = 0;
                    updateScores();
                } else {
                    statusDiv.textContent = `‚ùå –ù–µ–≤–µ—Ä–Ω–æ! –û—Å—Ç–∞–ª–æ—Å—å: ${lives}`;
                }
            }
        }

        function newGame() {
            currentWordObj = words[Math.floor(Math.random() * words.length)];
            categoryDiv.textContent = `–ö–∞—Ç–µ–≥–æ—Ä–∏—è: ${currentWordObj.cat}`;
            guessedLetters = new Set();
            lives = 6;
            statusDiv.textContent = '–í—ã–±–µ—Ä–∏ –±—É–∫–≤—É!';
            updateWordDisplay();
            updateLives();
            drawHangman();
            createKeyboard();
            updateScores();
        }

        newGameBtn.addEventListener('click', newGame);
        updateScores();
        newGame(); // –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫!
    </script>
</body>
</html>
